@model Learner.Controllers.QuizzerViewModel

@{
    ViewBag.Title = "Quizzer";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div ng-app="xyz">
    <div ng-controller="QuizCtrl" ng-init="init()">
        <div id="itemDialog" class="modal hideXX" ng-show="selectedEntrySet && selectedEntrySet.entries.length > selectedEntryIndex" style="width: 320px; position: absolute">
            <div class="modal-header">{{selectedEntrySet.name}}</div>
            <div id="itemText" class="modal-body">{{selectedEntry.text}}</div>  
            <div class="modal-footer">
                <a id="google" href="#" class="btn">Google!</a>
                <a id="anotherTopic" href="#" class="btn" ng-click="anotherTopic()">New Topic</a>
                <a id="delete" href="#" class="btn" ng-click="deleteEntry(selectedEntrySet, selectedEntry)">Del</a>
                <a href="#" class="btn btn-primary" ng-click="next()">Ok</a>
            </div>  
        </div>
    
        <button ng-click="sortTopics()">Reorder</button>
        <button ng-click="newestFirst()">Newest First</button>
        <button ng-click="recreateJson()">Recreate</button>
        <button ng-click="initAddMode()">Add</button>

        <div ng-show="addMode">
            <input type="text" ng-model="entryName"></text>
            <textarea ng-model="newContent">

            </textarea>
            <button ng-click="add()">Add</button>
        </div>
        
        <pre>{{getScope()}}</pre>
        <div>
            
            <div ng-repeat="quizTopic in jsonified">
                <span ng-click="openTopic(quizTopic)">Name: {{quizTopic.name}} [{{quizTopic.entries[0].text.substring(0, 40)}}] ({{quizTopic.entries.length}})</span> <a href="#" ng-click="editSelected(quizTopic)">Edit</a>
                
                 <div ng-show="editMode && quizTopic == selectedEntrySet">
                    <input ng-model="quizTopic.name" />
                    <div ng-repeat="entry in quizTopic.entries">
                        <input ng-model="entry.text"></input><button ng-click="deleteEntry(quizTopic, entry)"><i class="icon-remove-circle"></i>Del</button>
                    </div>
                </div>
            </div>
        </div>
        
    </div>
</div>



@section scripts
{
    <script type="text/javascript" src="~/Scripts/app/quizzerController.js"></script>

    <script type="text/javascript" src="~/Scripts/Data/quizzerData.js"></script>
    <script type="text/javascript">
        function fisherYates(myArray) {
            var i = myArray.length, j, tempi, tempj;
            if (i == 0) return false;
            while (--i) {
                j = Math.floor(Math.random() * (i + 1));
                tempi = myArray[i];
                tempj = myArray[j];
                myArray[i] = tempj;
                myArray[j] = tempi;
            }
        }

        $("#google").click(function() {
            var searchString = $("#itemText").text();
            window.open("https://www.google.com/?q=" + searchString, '_blank');
        });


        app = angular.module("xyz", function() {
        });
    </script>
}
